# Нормализация названий товаров

## Описание функционала

Бот поддерживает автоматическую нормализацию названий товаров в заказах с помощью эталонного списка товаров и алгоритма fuzzy matching. Это позволяет приводить различные варианты написания товаров к единому стандартному виду.

## Как использовать

1. В меню заказа появилась новая кнопка "✨ Сделать текст красивее (тест)"
2. После ввода позиций заказа нажмите эту кнопку
3. Бот автоматически:
   - Сравнит каждую позицию заказа с эталонными названиями
   - Найдёт наиболее похожие названия (сходство ≥80%)
   - Заменит названия на эталонные
   - Покажет все внесённые исправления

## Редактирование эталонных товаров

### Файл known_items.json

Эталонные названия товаров хранятся в файле `known_items.json` в корне репозитория.

**Формат файла:**
```json
[
  "Лабубу",
  "Товар2", 
  "Товар3"
]
```

### Как добавить новые товары:

1. Откройте файл `known_items.json` в любом текстовом редакторе
2. Добавьте новое название товара в кавычках
3. Не забудьте поставить запятую после предыдущего элемента
4. Сохраните файл

**Пример добавления товара:**
```json
[
  "Лабубу",
  "Товар2", 
  "Товар3",
  "Новый товар"
]
```

### Как редактировать существующие товары:

1. Найдите нужный товар в списке
2. Измените его название, сохраняя кавычки
3. Сохраните файл

**Пример:**
```json
[
  "Лабубу Premium",
  "Товар2", 
  "Товар3 Extended"
]
```

### Как удалить товары:

1. Удалите строку с товаром
2. Уберите лишнюю запятую, если товар был не последним
3. Сохраните файл

### Правила оформления:

- ✅ Используйте UTF-8 кодировку
- ✅ Каждый товар в отдельных кавычках
- ✅ Запятая после каждого элемента, кроме последнего
- ✅ Квадратные скобки в начале и конце
- ❌ Не используйте одинарные кавычки
- ❌ Не забывайте запятые между элементами

### Проверка корректности файла:

После редактирования можете проверить файл онлайн-валидатором JSON или использовать команду:
```bash
python3 -m json.tool known_items.json
```

### Примеры использования:

**До нормализации:**
- лабубу
- товар 2
- ТОВАР3
- лабуб

**После нормализации:**
- Лабубу ← исправлено с "лабубу"
- Товар2 ← исправлено с "товар 2"  
- Товар3 ← исправлено с "ТОВАР3"
- Лабубу ← исправлено с "лабуб"

## Технические особенности

- Алгоритм: rapidfuzz с порогом сходства 80%
- Сравнение не учитывает регистр
- При нескольких похожих вариантах выбирается наиболее близкий
- Если сходство меньше 80%, товар остаётся без изменений
- Пустые строки в файле автоматически игнорируются